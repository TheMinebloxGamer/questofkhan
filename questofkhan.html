frameRate(144);


/**QUEST OF KHAN v1.2
 * -Bennimus Studios-
 * 
 * Changelog:
 * v1.2____
 * Added Speed run mode (press G)
 * v1.1____
 * Moar levels!
 * Boss stage (incomplete. Currently just sits there)
 * v1.0
 * Multiplayer
 * Levels
 * Spikes, checkpoints, and conveyor }'s
**/
//Feel up for a challenge? Try Speed Run Mode! Press G
//Your run will be timed, and dying will give a 10-second penalty. Don't die!
//Speed run high scores
//If you must know, my record is 0:46:45
var highScores = [[1,12,67,   "Vetrix"],
                  [1,54,22,   "Gabriel"],
                  [2,15,0,    "Geometry Wars EvolvedÂ²"]];
var speedRun = false;
var scroll = 0;
var scroll_2 = 0;
var stage = null;
var prepTimer = 0;
var keys = [];
var Player2 = false;
var xPow = 0, xPow2 = 0;
var yPow = 0, yPow2 = 0;
var cX = 201,cY = 201, cX2 = cX, cY2 = cY;
var posX = cX, posX2 = cX2;
var posY = cY, posY2 = cY2;
var posA = 0, posA2 = 0;
var posB = 0, posB2 = 0;
var dead = false, dead2 = false;
var deadTimer = 0, deadTimer2 = 0;
frameRate(150);
var time = [0,0,0];
var timeStarted = false;
var endGame = false;
var world = [[
    "|-Bennimus Studios-                    (Don't forget to vote up!)",
    "|WELCOME TO QUEST OF KHAN!",
    "|",
    "|A and D keys to move Left and Right           <LEVEL 1>",
    "|W key to jump",
    "|Player 2 press any arrow key to join",
    "|Press G to begin Speed Run mode!",
    "|Go this way ==>",
    "|",
    "|",
    "|",
    "|                                                                     (==========)",
    "|",
    "|",
    "|======================================          ==============",
    "|___    ____    ____    ____    ______/          \\___    _____/",
    "|   \\  /    \\  /    \\  /    \\  /                     \\  /",
    "|   OOOO    OOOO    OOOO    OOOO                     OOOO",
    "|    ||      ||      ||      ||       |^^^^^^^^^|     ||",
    "|    ||      ||      ||      ||DON'T TOUCH THE SPIKES!||"],
    [
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "   I AM A PLATFORM",
    "",
    "                   <O==O>",
    "",
    "                           <O==O>                      println('Hello, World!');",
    "",
    "",
    "                           You can jump on text",
    "                           to accomplish goals",
    "                           that may seem beyond",
    "                           your reach",
    "",
    ""],
    [
    "",
    "",
    "",
    "",
    "                                       <LEVEL 2>",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "       This is a checkpoint => /TT#TT\\ Activates immediately upon rolling on it",
    "                               \\_____/",
    ""],
    [
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "                           {{{{{{{{{{{{{{{{{{{{{{{{{",
    "                           These make you go faster.",
    "",
    "",
    "rect(3, 33, 97, 96);",
    "",
    "",
    "",
    "",
    "",
    ""],
    [
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "      {{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{",
    "      .................................J U M P !.........................",
    "",
    "",
    "",
    "",
    "",
    ""],
    [
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "                                                         }}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}===/#\\Well, to be a little more accurate, the hashtag symbol is the checkpoint.",
    "",
    "",
    ""],
    [
    "",
    "",
    "",
    "",
    "                                                   <=========={{{{{{{{{{{{{{{{{{{",
    "                                                           |A leap of faith...",
    "                                                           |",
    "                                                           |",
    "                   H_H_H_H_H",
    "                    |     |",
    "                    | O   |",
    "                    |     |",
    "fill(255, 6, 5);    |   O |=====================(#)===================={{{{{{{{{{",
    "                   _|_____|__________________________________     _______",
    "                  |                               |          \\  /        \\    /",
    "                  |_______________________________|          OOOO         |  |",
    "                 /                                \\           ||          |   \\",
    "                |      Have you voted up yet?      \\          ||          |   |",
    "                 \\_________________________________/          ||          |  /",
    "                                                              ||          |  \\"],
    [
    "",
    "",
    "",
    "",
    "{{{{{{{{{{{{{{>",
    "",
    "",
    "",
    "                 +===|}}}}}|===+                                          }}}}}}}}}}}}}}}}}}}}>",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    ""],
    [
    "",
    "",
    "",
    "",
    "               <LEVEL 3>",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "       +======================+-<(|#|)>-It's bouncy down there!",
    "",
    "",
    "",
    "",
    "                                                                   000000000000",
    ""],
    [
    "",
    "",
    "",
    "",
    "",
    "",
    "Up here!                                               {{{{{{{{{{{{            ",
    "",
    "",
    "            Now try these!",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "                                   000000000",
    ""],
    [
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{00                   ",
    "",
    "",
    "",
    ""],
    [
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "               G   E   T       R   E   A   D   Y       T   O       J   U   M   P  ",
    "",
    "",
    "",
    "",
    "{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{000000000000000000000000000000000000000000000000000000000000000000000000000000                                                                                                                               ",
    "",

    "",
    "",
  
    "",
    "}}}}}}}}}######################################################################################################################################}}}}}And he sticks the landing! <#>.              You probably died the first time. That's ok. You're supposed to. [#]",
    "",
    "",
    "",
    "",
    ""],
    [
    "",
    "",
    "",
    "",
    "",
    "                                                                                                       <LEVEL 4>",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "#####################################################################################################################################################################################################################################################################################000000000000000000000000000000000000000000000",
    "       You didn't forget about the spikes did you?                                 Or about voting up...",
    "",
    "",
    ""],
    [
    "",
    "",
    "",
    "",
    "",
    "<^^^^^^^^>----------<)",
    "",
    "",
    "                       }}}}}}}}}}}}}}}}}}}^^^^^^^^^^^^^^}}}}}}}}}>=====\\",
    "                       I suppose this is one of those 'OH NOES'",
    "                       momments in gaming...",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "                                                                       \\============-#-====",
    ""],
    [
    "",
    "                           ____",
    "                          /    \\",
    "                         /      \\",
    "                         \\      /",
    "                          \\____/",
    "",
    "                       <Not Finished!!",
    "                       <BOSS STAGE 01>",
    "                       <Super Hexagon>",
    "                       <VirusTM>",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "================================================================================>",
    ""],
    [
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    ""],
    ];
var boss = {
    hexagon: {
        obstacles: {
            x: [],
            y: [],
            length: [],
            direction: []
        },
        pulse: 0,
        blink: 0,
        health: 3,
        rotation: 0,
        engaged: false
    }
};
var newWorld = [];
for(var i = 0; i < 20; i++){
    newWorld[i]="";
}
for(var i = 0; i < world.length; i++){
    var mostChars = 0;
    for(var j = 0; j < 20; j++){
        if(world[i][j].length>mostChars){
            mostChars=world[i][j].length;
        }
    }
    for(var j = 0; j < 20; j++){
        for(var k = world[i][j].length; k < mostChars; k++){
            world[i][j]+=" ";
        }
    }
}
for(var i = 0; i < world.length; i++){
    for(var j = 0; j < world[i].length; j++){
        newWorld[j]+=world[i][j];
    }
}
world = newWorld;
var getChunk = function(x, y){
    try{
        if(y>=0&&y<20){
            return world[y].substr(x,1);
        }else{
            return " ";
        }
    }catch(e){
        return " ";
    }
};
var scroll2 = 0, scroll2_2 = 0;
draw = function() {
    try {
    if(keys[82]&&speedRun){
        cX = 201;
        cY = 201;
        posX = cX;
        posY = cY;
        xPow = 0;
        yPow = 10;
        time=[0,0,0];
        timeStarted=false;
    }
    if(keys[71]){
        if(speedRun){
            speedRun=false;
            time=[0,0,0];
        }else{
            Player2 = false;
            cX = 201;
            cY = 201;
            posX = cX;
            posY = cY;
            xPow = 0;
            yPow = 10;
            speedRun=true;
        }
        keys[71]=false;
    }
    background(255);
    if(boss.hexagon.engaged){
        endGame = true;
        background(71, 0, 0);
        var dd = [], ee = [], ff = [], gg = [];
        for(var i = 0; i < 6; i++){
            dd[i] = sin(i*60);
            ee[i] = cos(i*60);
            ff[i] = dd[i]*500;
            gg[i] = ee[i]*500;
        }
        noStroke();
        translate(200, 30);
        rotate(boss.hexagon.rotation-2);
        fill(97, 0, 0);
        for(var i = 0; i < 3; i++){
            quad(dd[i*2],ee[i*2],ff[i*2],gg[i*2],ff[i*2+1],gg[i*2+1],dd[i*2+1],ee[i*2+1]);
        }
        resetMatrix();
    }
    if((keys[UP]||keys[DOWN]||keys[RIGHT]||keys[LEFT])&&!speedRun){
        Player2=true;
    }
    scroll2=scroll;
    if(scroll2>12){
        while(scroll2>12){
            scroll2-=12;
        }
    }
    scroll2_2=scroll_2;
    if(scroll2_2>12){
        while(scroll2_2>12){
            scroll2_2-=12;
        }
    }
    posA = round(posX/12);
    posB = round(posY/20-0.5)-3;
    posA2 = round(posX2/12);
    posB2 = round(posY2/20-0.5)-3;
    textFont(createFont("Courier", 20), 20);
    fill(0);
    if(boss.hexagon.engaged){
        fill(255);
    }
    for(var i = 0; i < 20; i++){
        if(Player2){
            text(world[i].substr(round(scroll/12-0.5), 17), -scroll2, i*20+20);
        }else{
            text(world[i].substr(round(scroll/12-0.5), 34), -scroll2, i*20+20);
        }
    }
    if(Player2){
        for(var i = 0; i < 20; i++){
            text(world[i].substr(round(scroll_2/12-0.5), 18), -scroll2_2+200, i*20+20);
        }
    }
    translate(posX-scroll, posY);
    rotate(posX-200);
    noStroke();
    if(!dead){
        fill(255, 0, 0);
        if(Player2){
            ellipse(0,0,85,85);
        }
        image(getImage("creatures/Winston"), -40, -40, 80, 80);
    }else if(round((deadTimer+1)/10)&1){
        fill(255, 0, 0);
        if(Player2){
            ellipse(0,0,85,85);
        }image(getImage("creatures/Winston"), -40, -40, 80, 80);
    }
    fill(0, 0, 255);
    resetMatrix();
    if(Player2){
    if(dist(posX2,0,posX-10,0)<90){
        text("P2", posX2-scroll, posY2);
    }else{
        if(posX2<posX){
            ellipse(5, posY2, 10, 10);
        }else{
            ellipse(190, posY2, 10, 10);
        }
    }
    }
    translate(posX2-scroll_2+200, posY2);
    rotate(posX2-200);
    if(!dead2&&Player2){
        fill(0, 0, 255);
        ellipse(0,0,85,85);
        image(getImage("creatures/Winston"), -40, -40, 80, 80);
    }else if(round((deadTimer2+1)/10)&1&&Player2){
        fill(0, 0, 255);
        ellipse(0,0,85,85);
        image(getImage("creatures/Winston"), -40, -40, 80, 80);
    }
    resetMatrix();
    fill(255, 0, 0);
    if(Player2){
    if(dist(posX2,0,posX+10,0)<90){
        text("P1", posX-scroll_2+200, posY);
    }else{
        if(posX<posX2){
            ellipse(210, posY, 10, 10);
        }else{
            ellipse(395, posY, 10, 10);
        }
    }
    }
    if(!dead){
        posX+=xPow/10;
        posY+=yPow/10;
    }
    if(posB>=15){
        dead=true;
    }
    if(xPow>0){
        xPow-=0.001;
    }
    if(yPow>0){
        yPow-=0.1;
    }
    if(xPow<0){
        xPow+=0.001;
    }
    if(Player2){
    if(!dead2){
        posX2+=xPow2/10;
        posY2+=yPow2/10;
    }
    if(posB2>=15){
        dead2=true;
    }
    if(xPow2>0){
        xPow2-=0.001;
    }
    if(yPow2>0){
        yPow2-=0.1;
    }
    if(xPow2<0){
        xPow2+=0.001;
    }
    }
    if(getChunk(posA, posB+5)!==" "||getChunk(posA-1, posB+5)!==" "||getChunk(posA+1, posB+5)!==" "){
        if(xPow>0){
            xPow-=0.01;
        }else if(xPow<0){
            xPow+=0.01;
        }
        if(getChunk(posA, posB+5)==="^"||getChunk(posA-1, posB+5)==="^"||getChunk(posA+1, posB+5)==="^"){
            dead=true;
        }
        if((getChunk(posA, posB+5)==="#"||getChunk(posA-1, posB+5)==="#"||getChunk(posA+1, posB+5)==="#")){
            cX = posX;
            cY = posY;
        }
        if(getChunk(posA, posB+5)==="{"||getChunk(posA-1, posB+5)==="{"||getChunk(posA+1, posB+5)==="{"&&xPow<=50){
            xPow+=0.5;
        }
        if(getChunk(posA, posB+5)==="}"||getChunk(posA-1, posB+5)==="}"||getChunk(posA+1, posB+5)==="}"&&xPow>=-50){
            xPow-=0.5;
        }
        if(getChunk(posA, posB+5)==="0"||getChunk(posA-1, posB+5)==="0"||getChunk(posA+1, posB+5)==="0"&&xPow>=-50){
            yPow=-30;
            if(keys[87]){
                yPow=-70;
            }
        }
        if(yPow>-0.5&&yPow<0){
            yPow=0;
        }
        if(yPow>=0){
            posY=posB*20+71;
            if(keys[87]){
                yPow=-40;
            }
        }
    }else{
        yPow+=1;
    }
    if(Player2){
    if(getChunk(posA2, posB2+5)!==" "||getChunk(posA2-1, posB2+5)!==" "||getChunk(posA2+1, posB2+5)!==" "){
        if(xPow2>0){
            xPow2-=0.01;
        }else if(xPow2<0){
            xPow2+=0.01;
        }
        if(getChunk(posA2, posB2+5)==="^"||getChunk(posA2-1, posB2+5)==="^"||getChunk(posA2+1, posB2+5)==="^"){
            dead2=true;
        }
        if((getChunk(posA2, posB2+5)==="#"||getChunk(posA2-1, posB2+5)==="#"||getChunk(posA2+1, posB2+5)==="#")){
            cX2 = posX2;
            cY2 = posY2;
        }
        if(getChunk(posA2, posB2+5)==="{"||getChunk(posA2-1, posB2+5)==="{"||getChunk(posA2+1, posB2+5)==="{"&&xPow2<=50){
            xPow2+=0.5;
        }
        if(getChunk(posA2, posB2+5)==="}"||getChunk(posA2-1, posB2+5)==="}"||getChunk(posA2+1, posB2+5)==="}"&&xPow2>=-50){
            xPow2-=0.5;
        }
        if(getChunk(posA2, posB2+5)==="0"||getChunk(posA2-1, posB2+5)==="0"||getChunk(posA2+1, posB2+5)==="0"&&xPow2>=-50){
            yPow2=-30;
            if(keys[UP]){
                yPow2=-70;
            }
        }
        if(yPow2>-0.5&&yPow2<0){
            yPow2=0;
        }
        if(yPow2>=0){
            posY2=posB2*20+71;
            if(keys[UP]){
                yPow2=-40;
            }
        }
    }else{
        yPow2+=1;
    }
    }
    if(keys[65]&&xPow>-35){
        xPow-=0.45;
        if(xPow<-34.5){
            xPow=-35.5;
        }
    }
    if(keys[68]&&xPow<35){
        xPow+=0.45;
        if(xPow>34.5){
            xPow=35.5;
        }
    }
    if(Player2){
    if(keys[LEFT]&&xPow2>-35){
        xPow2-=0.45;
        if(xPow2<-34.5){
            xPow2=-35.5;
        }
    }
    if(keys[RIGHT]&&xPow2<35){
        xPow2+=0.45;
        if(xPow2>34.5){
            xPow2=35.5;
        }
    }
    }
    if(deadTimer===0&&dead){
        deadTimer=160;
        if(speedRun){
            time[1]+=10;
        }
    }
    if(deadTimer>1){
        deadTimer--;
        timeStarted=false;
        xPow=0;
        if(speedRun){
            fill(255, 0, 0);
            text("10 second penalty", 20, 200);
        }
    }
    if(!dead){
        if(posX>200&&posA<world[0].length-15){
            scroll=posX-200;
            if(Player2){
                scroll=posX-100;
            }
        }else if(posA<world[0].length-15){
            scroll=0;
        }else{
            scroll=(world[0].length-31)*12-7;
            if(Player2){
                scroll=(world[0].length-31)*12+193;
            }
        }
    }else if(deadTimer===1){
        scroll=round(scroll);
        if(scroll<=cX-150&&scroll>=cX-250){
            posX=cX;
            posY=cY;
            xPow=0;
            yPow=-20;
            dead=false;
            deadTimer=0;
        }
        if(scroll<cX-200){
            scroll+=12;
            if(scroll<cX-1000){
                scroll+=25;
            }
        }else if(scroll>cX-200){
            scroll-=12;
            if(scroll>cX+1000){
                scroll-=25;
            }
        }
    }
    if(Player2){
    if(deadTimer2===0&&dead2){
        deadTimer2=160;
    }
    if(deadTimer2>1){
        deadTimer2--;
    }
    if(!dead2){
        if(posX2>200&&posA2<world[0].length-15){
            scroll_2=posX2-100;
        }else if(posA2<world[0].length-15){
            scroll_2=0;
        }else{
            scroll_2=(world[0].length-31)*12+193;
        }
    }else if(deadTimer2===1){
        scroll_2=round(scroll_2);
        if(scroll_2<=cX2-150&&scroll_2>=cX2-250){
            posX2=cX2;
            posY2=cY2;
            xPow2=0;
            yPow2=-20;
            dead2=false;
            deadTimer2=0;
        }
        if(scroll_2<cX2-200){
            scroll_2+=12;
            if(scroll_2<cX2-1000){
                scroll_2+=25;
            }
        }else if(scroll_2>cX2-200){
            scroll_2-=12;
            if(scroll_2>cX2+1000){
                scroll_2-=25;
            }
        }
    }
    }
    if(posX<=50){
        xPow=abs(xPow/3);
        posX+=xPow;
    }
    if(posX>=(world[0].length-2)*12){
        xPow=-abs(xPow/3);
        posX+=xPow;
    }
    if(Player2){
    if(posX2<=50){
        xPow2=abs(xPow2/3);
        posX2+=xPow2;
    }
    if(posX2>=(world[0].length-2)*12){
        xPow2=-abs(xPow2/3);
        posX2+=xPow2;
    }
    }
    if(Player2){
        stroke(0, 0, 0);
        strokeWeight(10);
        line(200, 0, 200, 400);
        fill(255);
        strokeWeight(1);
        rect(75, 0, 250, 50);
        if(posX>posX2){
            fill(255, 0, 0);
            text("PLAYER 1 AHEAD", 110, 25);
        }else if(posX<posX2){
            fill(0, 0, 255);
            text("PLAYER 2 AHEAD", 110, 25);
        }
    }
    if(boss.hexagon.engaged){
        if(posX<20500||(Player2&&posX2<20500)){
            boss.hexagon.engaged=false;
        }
        stage = boss.hexagon;
        stage.rotation++;
        if(stage.blink<=0){
            stage.blink=255;
        }else{
            stage.blink--;
        }
        if(stage.pulse>=0){
            stage.pulse--;
        }else{
            stage.pulse=75;
        }
        fill(0);
        strokeWeight(5);
        stroke(255, stage.blink, 0);
        if(prepTimer>1){
            prepTimer--;
            translate(200, (100-prepTimer)/5);
            if(Player2){
                translate(-100, 0);
                rotate(stage.rotation);
                beginShape();
                for(var i = 0; i <= 6; i++){
                    vertex(sin(i*60)*50,cos(i*60)*50);
                }
                endShape();
                resetMatrix();
                translate(300, (100-prepTimer)/5);
            }
            rotate(stage.rotation);
            beginShape();
            for(var i = 0; i <= 6; i++){
                vertex(sin(i*60)*50,cos(i*60)*50);
            }
            endShape();
            resetMatrix();
        }else{
            if(Player2){
                translate(100, 35);
                rotate(stage.rotation);
                beginShape();
                for(var i = 0; i <= 6; i++){
                    vertex(sin(i*60)*(50+(stage.pulse/5)),cos(i*60)*(50+(stage.pulse/5)));
                }
                endShape();
                resetMatrix();
                translate(300, 35);
                rotate(stage.rotation);
                beginShape();
                for(var i = 0; i <= 6; i++){
                    vertex(sin(i*60)*(50+(stage.pulse/5)),cos(i*60)*(50+(stage.pulse/5)));
                }
                endShape();
                resetMatrix();
            }else{
                translate(200, 35);
                rotate(stage.rotation);
                beginShape();
                for(var i = 0; i <= 6; i++){
                    vertex(sin(i*60)*(50+(stage.pulse/5)),cos(i*60)*(50+(stage.pulse/5)));
                }
                endShape();
                resetMatrix();
            }
        }
        boss.hexagon = stage;
    }if(keys[66]){
        boss.hexagon.engaged=false;
    }
    if(Player2){
        if(posX>21800&&posX2>21800&&boss.hexagon.health>0&&!boss.hexagon.engaged){
            boss.hexagon.engaged=true;
            prepTimer=500;
        }
    }else{
        if(posX>21800&&boss.hexagon.health>0&&!boss.hexagon.engaged){
            boss.hexagon.engaged=true;
            prepTimer=500;
        }
    }
    if(speedRun){
        if(timeStarted&&!endGame){
            time[0]++;
        }
        if(xPow!==0){
            timeStarted=true;
        }else if(!dead){
            fill(255, 0, 0);
            text("Start moving to begin\nspeed run!",20,200);
        }
        if(time[0]>=100){
            if(time[0]===100){
                time[1]++;
            }
            while(time[0]>=100){
                time[0]-=100;
            }
        }
        if(time[1]>=60){
            time[2]++;
            time[1]-=60;
        }
        fill(255);
        stroke(0);
        rect(-1, -1, 401, 51);
        fill(0);
        textAlign(RIGHT, TOP);
        text(time[2]+":"+(time[1]<10?"0"+time[1]:time[1])+":"+(time[0]<10?"0"+time[0]:time[0]), 400, 0);
        text("SPEED RUN", 400, 30);
        textAlign(LEFT, BOTTOM);
        fill(255, 0, 0);
        text("G: Stop speed run\nR: Restart run", 0, 40);
        if(endGame){
            background(255);
            var bestTime = time[2]*6000+time[1]*100+time[0];
            var bestTime2 = [];
            for(var i = 0; i < 3; i++){
                bestTime2[i] = highScores[i][0]*6000-0+highScores[i][1]*100-0+highScores[i][2]-0;
            }
            if(bestTime < bestTime2[0]){
                fill(130, 108, 0);
                text("Congratulations!\nYou beat "+highScores[0][3]+"'s score with\n"+time[2]+":"+(time[1]<10?"0"+time[1]:time[1])+":"+(time[0]<10?"0"+time[0]:time[0])+" to achieve First Place!", 10, 250);
                fill(255, 213, 0);
                text("Congratulations!\nYou beat "+highScores[0][3]+"'s score with\n"+time[2]+":"+(time[1]<10?"0"+time[1]:time[1])+":"+(time[0]<10?"0"+time[0]:time[0])+" to achieve First Place!", 11, 249);
            } else if(bestTime < bestTime2[1]){
                fill(100);
                text("Congratulations!\nYou beat "+highScores[1][3]+"'s score with\n"+time[2]+":"+(time[1]<10?"0"+time[1]:time[1])+":"+(time[0]<10?"0"+time[0]:time[0])+" to achieve Second Place!", 10, 250);
                fill(200);
                text("Congratulations!\nYou beat "+highScores[1][3]+"'s score with\n"+time[2]+":"+(time[1]<10?"0"+time[1]:time[1])+":"+(time[0]<10?"0"+time[0]:time[0])+" to achieve Second Place!", 11, 249);
            } else if(bestTime < bestTime2[2]){
                fill(71, 33, 0);
                text("Congratulations!\nYou beat "+highScores[2][3]+"'s score with\n"+time[2]+":"+(time[1]<10?"0"+time[1]:time[1])+":"+(time[0]<10?"0"+time[0]:time[0])+" to achieve Third Place!", 10, 250);
                fill(189, 85, 0);
                text("Congratulations!\nYou beat "+highScores[2][3]+"'s score with\n"+time[2]+":"+(time[1]<10?"0"+time[1]:time[1])+":"+(time[0]<10?"0"+time[0]:time[0])+" to achieve Third Place!", 11, 249);
            }
        }
    }
    }catch (e){
        noStroke();
        fill(255, 255, 255, 200);
        rect(0, 0, 400, 400);
        fill(255, 0, 0);
        text(e, 20, 200, 350, 400);
    }
};
keyPressed = function(){
    keys[keyCode]=true;
};
keyReleased = function(){
    keys[keyCode]=false;
};